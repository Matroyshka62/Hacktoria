## The Sleeper Cell
![TheSleeperImage](https://hacktoria.com/wp-content/uploads/2023/01/pixelcover-the-sleeper-cell-768x768.png)  
This [Hacktoria Contract](https://hacktoria.com/contracts/the-sleeper-cell/) dropped on 04 Jan 2023
# Preamble  
We are presented with a scenario which I'll let you read for yourself - TLDR; Derek a sleeper with the Androktasiai Terrorist group has received activation orders.  
Let's head straight into the briefing...  
```
### Briefing
Greetings, Special Agent K.

We have an urgent matter on our hands. For several months we’ve been investigating a group called “Androktasiai”. A radical organization who believes in cleansing the planet of what they call gluttony. Believing firmly that humans are a disease that needs to be exterminated, this radical group is well organized and is preparing to strike several targets.

After breaching one of their email accounts, we were able to extract a sent item. The metadata didn’t prove to be of much help, as it was sent to a disposable 10minutemail address.

The contents however are of great interesting. We believe it contains instructions sent from one of the groups’ leaders to a sleeper cell. This sleeper cell will now be activated and preparing to carry out an attack somewhere.

It is your task to figure out what the text means and provide any intelligence about the plans of this organization.

As always, Special Agent K. The Contract is yours, if you choose to accept.
```
And the encrypted message
```
SSB1cmdzIG9rZSBscGlhIHR2cHYgbXluIGhzZGUgaWxlaHJyaSB5b212ZCB3dWcgZXAgaHJ4IHdnemRhIGF5dXZvbnIgc2h3a21uICh2aSBwY2UgdHJ3IHZvYiBtYnZrIHJlZWwsIGFvbndybnFrLCBveHcgZmd3bHFzdSkgd3lzIG14cmxpaXYgbW53a3NiIGhmIGxwZSB0ZW51ZXNuIEloYXRvYW9ja3ZmYyB1bHdhc21kIGZ3ZmJvLCBwaHd6ZXduIE5vdHZvZnkgb3dyc3MsIGprenpvIHBlIHd2ZG1haXJpIGh5IGllam5la3QgZ2t2IHd3aWVqbmVrdCwgbnF1IGhydHQgb3F0cCB0dWxldWMgZm9qbSB0cGVhIHN2ZnB4Y2wuIElubCBmYnUga3ZrbSBuc2J1emUgdWRqIHJvZWlubXJtZCBodiBrdm8gYm1obXJuZXB3IGZidnIgd2FiaCBiaHIgc3ZmcHhjbCwgcXQgcXMgYnhpIGRra3QgbHcgbWlrciB3eXMgd3R0bG1yIChxbiBna3YgdHlrbXd6IENwYWN3dmZjIHdldXRhemVxIHhlaHkgbnMpIGV3cm0gdHVoZSBkb2tmd2t0IGp5IGJ4aSBvYm1peHFjcWF5IG9ycHlrLiBBZmwgaW4gd3IgbmVjZyBnb2wgYmhtIG1ucWVzYiBoZiBvd3JzaWFqLCBudmttIGlrIGJobSBjbnhqcyBkYWFsIGVlIGxvIGFyayBnb3ggaGdlIG5pdGh1diAoa3JiY3ogd2YgdG9haiBrd3d4IGhzYSBwbXJzaHRob3cgbXdiYXRzKSBxcnZnIG1obmxxbmNheW9wIGt5a2shIFZ3IHdtIG5idyBqc28sIG1oc2IgaXYgdHVoIER3eHhzIGxwcnd1dGsga3ZvIHZvZmJpdnVubyB5c2ttIHR6aXQgcXMgdnEga3ZvIGZvbXZ0aWlhdiBrdm9rZWduLCB0cGUgdHVmZ2NnZWthIG9uIHdud3ZmIHNsIHNnIGxla29wd3ZyIGtnZCBscGlra3JxdnIsIGRhYWwgcW4ga29hd3piZXRudW0gb24gdHZwdiB3ZCB1ZXV3bW1zIE51eHN4bS12YWRlPyBJbnEgd3lvZCBoZiBscGUgbmFncXZnYyBoZiBscGUgbWFld3kgaHJrb21vaCBiaHIgdnJhbyBhZXNiIGF2ZCBxaHRjbW1pZ3YsIFNjbGNrbGYgc2wgZWZvZXZkcnV2ciEgS2dkIGxwYWIgdHV1ZmlxYSB0em0gc2ltciBrdm9kIHBpbHBvY3QgdnFrc2JmaWthaXduIHByZWhzZ3V3bCBpdiB0dWhkLCBvdmUgbXdiYXRzIG51diBzeHplZmxlemVxIHJ3IGhyeG0gc2tjd3JxbGV1IGRoIHR6bWl6IHBodXpoaSB0bnYgcW14dWVsa20/IGtnZCBscGFiIG5ud2xmbyB3b3dhIGJnIGRyZmZxZGJvZiBpbHduciBzdmZweGNsIHdyIHVheGggcnp2IGZlbGlsYSwgYWYgenZ6diBpZWpuZWt0IG52IHphenhyeG1jYj8gMCBla3dpc3d4IG1zbG5tc2YhIHp5b2QsIEIgcGppeSBnb2gsIGZmYmNtcnNxbmEgeWJ4IGtjIGN4ZWMgYm8geGVlaXZxZCBtaHcgbm96ZWZkenIgZGFpZm9zIGp5IGZ3aW94emUgZW1saW5wa2Z6c3ZhZCBpbmwgZm5xa29jbWl1aWwgemV0bGRzeG1zISBzYSBvdmUgZmRwZzogR2hlIGx3IHl3dSBna3JoIGdibGQgd3ZtcnByZHMgeHR0bXplLCBpbnEgcHJ5byBmZWxpbGEgbWJ1diBocnhuIGhtcm5lcHcgc20gayBnZW8gemVvaXpoZWgsIHlrIHdnemsgYXBleGV1IHBrb2UgZ29jciBiemUgZ29nc3d0ZWFzIG91cnd4bC4gR2dsIGhpcyB0bG1zeCBtbyBmaXRjcnIgZCBqaGJ0aXlwdCBlYWwsIHdmIGtzbSwgY2d2dHFuaGRjIHF5Z2Nna3Rxb2EsIGRlciBpaHUgZHFrbSBmYnJjZyBueHNocXNtIGlnLCByaSBzdmxlIGN2b2UgaWcgcWZoLiAoKENoRmEtQXRpZHZ4ZC0zMy45NTM0MTcsLTExOC4zMzg4NjMsMTgpKSBPcXRpZiwgbml6ZSBucXUgT2podCwgc3plIGF1c2l6cXN4bmwgbm96IHlieC4gUmJuIGJuIHN2b2JocnUgZ3prdmUsIFptYWIgcHJ1d3NtbXMgc3RsIGJodnF4Zy4gS2dkIHd0c213dWhpcywgY3hlLCBrbWUsIGFlciwgZGVyIGx4IG5nYiB3bWFlYi4gUmJuIGJuIHN2b2JocnUgZ3prdmUsIGRtdCBnb2h1IHd3YnggYncgb2V2dHloLCByYm4geGFrZywgd3BpcGsgc3NzZ2cgc3R3aXlmIGhoaWtlLCBtc2cgY3duZ2xlaW8gdXVqdml2ZzogbnF1IHpvbSBpbCB2b2IgaWFmaXNrbGUsIHh3ciBxZiB2dyB1Y29sLCB5Z2Mgc3BheW8gamlweWVqIG9ybWFnIG9mZ2MuIFRudiBxbiBpbmJ3eXNiIGlsc2tlLCBTbmJ6IHBjZSBtaHNiIGl2IG9haCBrdnNnZywgbHcgd3F0LCBna3YgZ2RobncsIGp5IHduciB6cm0sIGRoIHdhYiwgZG1jYmZrd3lnLCBhZmwgaXYgb2FoIG1zY2xlZCBiaG0gd3VyY3Mgd3RzbG1yZyBpZiBzdmZwaHJlbWQuIElucSBsZSBveGh0em1yIHhsbmZ2LCBka21pd3Z0dHksIG5xdSBxeWd0YXZ1aWx5YiwgcmJuIGJuIHN2b2JocnUgZ3prdmUsIHl6aXZkIHZ3IGpzZnhuIGxxbW1zLiBOcXUgd3ggdG5nYmhtciBjb3JxbywgQnQgYWEgZ3pvaHF1IGtzbWggeHFybSwgQWFnIHpiIGtnb2xwZXogcHlkdHMsIGRhaWsgZW96ayB2diBtc2JyIGxhc2UgYm8gZ2t2IHFieGFscW92IG9zIHByYjogcGhyIHNhIHRwZSBWcXdveG0gaWYgYmhtIGJyanpieGJueSBxcyB2b2h1emdyeGQgb3F0cCBsdmp5aCB3eGFsYSwgYmN0IGdrdiBweWdlayBqZXFudCB2a2ZvZ2dscGV2ZXEgenpociBsdGp3bm9lZTogdmYgaHJicyBlaXNiZWViIHJ6Y2gsIGZhenNiIGlnIHBsZ2QgYWFubSBhdiBlbnZwIHRza2UsIG9wZXplb2IgbnMgd25zbCBpbGVhbHYgbmNiZCBpZiBtdm1ybCBoamdvZ2N3IHdmIGxlcHJ0aHNobi4gU3ZkIGJoYnh4diBneCBhZGVhZ3MgZnN2b3UgaGYgcyBvZXZ0eWggd3dieCwgeXdiIGl2IHRleGt2LCBneCB0enFucyB0dWRrIHd4IHpvbm1ydmlhaiBrdm8gcG9qcywgdHBlIHNsaXMgd25zbCBpbGVhbHYgc20gdmJ0bHRlIGlucSBvemhkZWUgdG0gaXZjZWhyZ293IGFmbCBhY2d6aGVob3cgdWZibyBiaHIgaGVyLg==
```
We are also given the information that the flag to unlock the contract card is in the format ((this-is-the-flag))

This looks like stonewall Base64 encoding and time to call up your favourite decoder. In this case I used one of my favourites, and a Swiss Army tool of multiple encoding, encryption and forensic utilities, [Cyber Chef](https://gchq.github.io/CyberChef/)

Sure enough the 'Magic' module confirms Base64 and decodes the email...
```
I urgs oke lpia tvpv myn hsde ilehrri yomvd wug ep hrx wgzda ayuvonr shwkmn (vi pce trw vob mbvk reel, aonwrnqk, oxw fgwlqsu) wys mxrliiv mnwksb hf lpe tenuesn Ihatoaockvfc ulwasmd fwfbo, phwzewn Notvofy owrss, jkzzo pe wvdmairi hy iejnekt gkv wwiejnekt, nqu hrtt oqtp tuleuc fojm tpea svfpxcl. Inl fbu kvkm nsbuze udj roeinmrmd hv kvo bmhmrnepw fbvr wabh bhr svfpxcl, qt qs bxi dkkt lw mikr wys wttlmr (qn gkv tykmwz Cpacwvfc weutazeq xehy ns) ewrm tuhe dokfwkt jy bxi obmixqcqay orpyk. Afl in wr necg gol bhm mnqesb hf owrsiaj, nvkm ik bhm cnxjs daal ee lo ark gox hge nithuv (krbcz wf toaj kwwx hsa pmrshthow mwbats) qrvg mhnlqncayop kykk! Vw wm nbw jso, mhsb iv tuh Dwxxs lprwutk kvo vofbivuno yskm tzit qs vq kvo fomvtiiav kvokegn, tpe tufgcgeka on wnwvf sl sg lekopwvr kgd lpikkrqvr, daal qn koawzbetnum on tvpv wd ueuwmms Nuxsxm-vade? Inq wyod hf lpe nagqvgc hf lpe maewy hrkomoh bhr vrao aesb avd qhtcmmigv, Sclcklf sl efoevdruvr! Kgd lpab tuufiqa tzm simr kvod pilpoct vqksbfikaiwn prehsguwl iv tuhd, ove mwbats nuv sxzeflezeq rw hrxm skcwrqleu dh tzmiz phuzhi tnv qmxuelkm? kgd lpab nnwlfo wowa bg drffqdbof ilwnr svfpxcl wr uaxh rzv felila, af zvzv iejnekt nv zazxrxmcb? 0 ekwiswx mslnmsf! zyod, B pjiy goh, ffbcmrsqna ybx kc cxec bo xeeivqd mhw nozefdzr daifos jy fwioxze emlinpkfzsvad inl fnqkocmiuil zetldsxms! sa ove fdpg: Ghe lw ywu gkrh gbld wvmrprds xttmze, inq pryo felila mbuv hrxn hmrnepw sm k geo zeoizheh, yk wgzk apexeu pkoe gocr bze gogswteas ourwxl. Ggl his tlmsx mo fitcrr d jhbtiypt eal, wf ksm, cgvtqnhdc qygcgktqoa, der ihu dqkm fbrcg nxshqsm ig, ri svle cvoe ig qfh. ((ChFa-Atidvxd-33.953417,-118.338863,18)) Oqtif, nize nqu Ojht, sze ausizqsxnl noz ybx. Rbn bn svobhru gzkve, Zmab pruwsmms stl bhvqxg. Kgd wtsmwuhis, cxe, kme, aer, der lx ngb wmaeb. Rbn bn svobhru gzkve, dmt gohu wwbx bw oevtyh, rbn xakg, wpipk sssgg stwiyf hhike, msg cwngleio uujvivg: nqu zom il vob iafiskle, xwr qf vw ucol, ygc spayo jipyej ormag ofgc. Tnv qn inbwysb ilske, Snbz pce mhsb iv oah kvsgg, lw wqt, gkv gdhnw, jy wnr zrm, dh wab, dmcbfkwyg, afl iv oah mscled bhm wurcs wtslmrg if svfphremd. Inq le oxhtzmr xlnfv, dkmiwvtty, nqu qygtavuilyb, rbn bn svobhru gzkve, yzivd vw jsfxn lqmms. Nqu wx tngbhmr corqo, Bt aa gzohqu ksmh xqrm, Aag zb kgolpez pydts, daik eozk vv msbr lase bo gkv qbxalqov os prb: phr sa tpe Vqwoxm if bhm brjzbxbny qs vohuzgrxd oqtp lvjyh wxala, bct gkv pygek jeqnt vkfogglpeveq zzhr ltjwnoee: vf hrbs eisbeeb rzch, fazsb ig plgd aanm av envp tske, opezeob ns wnsl ilealv ncbd if mvmrl hjgogcw wf leprthshn. Svd bhbxxv gx adeags fsvou hf s oevtyh wwbx, ywb iv texkv, gx tzqns tudk wx zonmrviaj kvo pojs, tpe slis wnsl ilealv sm vbtlte inq ozhdee tm ivcehrgow afl acgzhehow ufbo bhr her.
```

Well, so far, so good, but clearly work to do. A couple of observations immediately jump out. The first is that we can see the flag format **((ChFa-Atidvxd-33.953417,-118.338863,18))** in the encrypted text and without going any further we can whack those co-ords into Google Maps (other mapping tools are available) and find that they may relate to the home of the LA Rams, **SoFi-Stadium**. Now if time is of the essence you might want to have a punt on ChFa-Atidvxd decoding to SoFi-Stadium - but where's the fun in that?

Move on to the second observation. The word length and overall structure suggest that we are dealing with a shift cipher of some sort. You can either try ROT-13 or observe that there are at least 6 occurrences of single letter words being enciphered to different letters, to convince yourself that we are dealing with a variable shift pattern using a key. Something like a [Vigenere Cipher](https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher). Which is a good place to start. If you have some known plaintext, or even have something that might be used as a key (like a name), you might want to start with that and see what works. The approach I used in this case was to use one of my go-to online tools. - [https://www.guballa.de/vigenere-solver](https://www.guballa.de/vigenere-solver). This tool is excellent if you are decoding into plaintext English (or German/French/Dutch/Spanish or Portuguese). Health warning it is not good at decoding URLs or things it won't recognise as normal language.

Sure enough - I pasted enough ciphertext to cover more than the length of a possible key into the tool and up popped some plaintext with the key it had found 'Androktasiai'. Using that I could decode the whole message confirming the target and the flag - ((SoFi-Stadium-33.953417,-118.338863,18))
